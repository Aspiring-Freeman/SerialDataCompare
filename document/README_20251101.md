# 串口数据分析工具

## 简介

这是一个用于分析和解析串口数据的工具，可以根据自定义的协议配置自动识别数据帧、解析字段内容并进行校验。

## 功能特点

- ✅ 支持自定义协议配置（帧头、帧尾、校验方式等）
- ✅ 自动识别和解析数据帧
- ✅ 多种校验算法支持（累加和、CRC16、CRC32、异或）
- ✅ 直观的表格显示分析结果
- ✅ 错误帧高亮显示
- ✅ 协议配置保存和加载
- ✅ 分析结果导出

## 安装

### 依赖项

```bash
pip install -r requirements.txt
```

主要依赖：
- PySide6 (Qt for Python)
- Python 3.8+

### 生成UI文件

在首次运行或修改UI后，需要生成Python UI文件：

```bash
pyside6-uic form.ui -o ui_form.py
```

## 使用方法

### 1. 启动程序

```bash
python main_window.py
```

### 2. 配置协议

首次使用时，需要先配置通信协议：

1. 切换到"协议配置"标签页
2. 设置基本参数：
   - 帧头标识（如：`68`）
   - 帧尾标识（如：`16`）
   - 校验方式（选择适合的校验算法）
   - 校验码位置
3. 定义数据字段：
   - 点击"添加字段"按钮
   - 填写字段名称、字节数、数据类型和说明
   - 可以调整字段顺序
4. 保存协议配置供后续使用

### 3. 输入和分析数据

1. 切换到"数据分析"标签页
2. 在输入框中输入十六进制数据，例如：
   ```
   68 00 03 01 02 03 16
   ```
3. 点击"开始分析"按钮
4. 查看分析结果：
   - 统计信息（总帧数、有效帧、错误帧）
   - 帧列表详情
   - 点击某一帧查看详细信息

### 4. 导出结果

点击"导出结果"按钮，选择保存路径和格式。

## 协议配置示例

工具提供了一个示例协议配置文件：`protocol_example.json`

协议格式：
```
帧头 | 设备地址 | 命令码 | 数据长度 | 数据域 | 校验码 | 帧尾
68  |    00    |   03   |    01    |   02   |   XX   | 16
```

你可以加载此配置作为起点，然后根据实际需求修改。

## 数据格式说明

### 输入格式

- 十六进制字符串
- 字节间可用空格、逗号或换行分隔
- 不区分大小写

示例：
```
68 00 03 01 02 03 16
68,00,03,01,02,03,16
680003010203 16
```

### 校验算法

1. **累加和**：所有数据字节相加，取低8位
2. **CRC16**：标准CRC16校验
3. **CRC32**：标准CRC32校验
4. **异或校验**：所有数据字节异或运算

## 目录结构

```
SerialDataCompare/
├── main_window.py          # 主程序入口
├── form.ui                 # Qt Designer UI文件
├── ui_form.py             # 生成的UI Python文件
├── requirements.txt        # 依赖项列表
├── protocol_example.json   # 示例协议配置
├── README.md              # 本文件
└── document/
    └── 功能说明.md         # 详细功能说明文档
```

## 开发说明

### UI设计修改

如果需要修改界面：

1. 使用Qt Designer打开 `form.ui`
2. 进行修改
3. 保存后运行：`pyside6-uic form.ui -o ui_form.py`
4. 重新运行程序

### 添加新功能

主要代码在 `main_window.py` 中，可以：
- 添加信号槽连接
- 实现数据解析逻辑
- 扩展校验算法

## 常见问题

**Q: 分析结果显示所有帧都是错误的？**  
A: 请检查协议配置是否正确，特别是帧头、帧尾和校验方式。

**Q: 无法识别数据帧？**  
A: 确保输入数据格式正确（十六进制），并且协议配置中的帧头帧尾设置正确。

**Q: 如何处理变长数据？**  
A: 在字段定义中，可以设置某个字段为"数据长度"，后续字段的长度由该字段决定。

## 版本历史

### V1.0 (2025-11-01)
- 初始版本发布
- 实现基础的数据分析功能
- 支持协议配置和保存
- 支持多种校验算法

## 许可证

[添加你的许可证信息]

## 联系方式

[添加你的联系方式]
